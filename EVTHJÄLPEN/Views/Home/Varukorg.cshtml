@model ViewProductAndReceipe

@using Microsoft.AspNetCore.Identity
@inject SignInManager<IdentityUser> SignInManager
@inject UserManager<IdentityUser> UserManager


@{
    ViewData["Title"] = "Varukorg";
}
<h1>@ViewData["Title"]</h1>
<br />

@if (Model.Productslist.Count == 0)
{
    <p>Varukorgen är tom</p>
}
else
{
    <h4>Produkter:</h4>


    @foreach (var item in Model.Productslist)
    {
        <div class="table">
            @*<p class="text-black-50" style="text-align:left; padding: 10px;">Portioner: </p>*@
            @{
                var parms = new Dictionary<string, string>()
{
                { "ProductId", item.ProductID.ToString() },
                { "Amount", (item.Amount + 1 ).ToString() }
            };
                var lowerparms = new Dictionary<string, string>()
{
                { "ProductId", item.ProductID.ToString() },
                { "Amount", (item.Amount - 1 ).ToString() }
            };
            }
        </div>

        <div class="row" style="padding:15px;">
            <div class="col-md-6">
                <ul class="list-group w-100">
                    <p>
                        @item.ProductName
                        <br /><i>@item.Quantity</i>
                        <br />
                        <br />
                        <a type="button" class="btn btn-danger" asp-controller="Home" asp-action="Varukorg" asp-all-route-data="@lowerparms">-</a>
                        <input type="text" value="@item.Amount" style="text-align: center; width:4%;" />
                        <a type="button" class="btn btn-success" asp-controller="Home" asp-action="Varukorg" asp-all-route-data="@parms">+</a>
                    </p>
                </ul>

            </div>


            <div class="col-md-6">

                <ul class="list-group w-100" style="text-align: right">
                    @item.Price Kr
                </ul>
                <a class="btn btn-outline-danger" type="button" value="Ta bort" style="float:right; padding-top:2px;"
                   asp-controller="Home" asp-action="Varukorg" asp-route-RemoveID="@item.ProductID">
                    Ta bort
                </a>

            </div>
        </div>
        <p style="border:1px; border-style:solid; border-color:#bcbcbc;"> </p>
    }

    <br />
    <a asp-controller="Home" asp-action="Varukorg" asp-route-Empty="Empty"> <input class="btn btn-outline-danger" type="button" value="Töm varukorg"> </a>
    <br />
    <br />
}
<p><b>TotalSumma:</b> @Math.Round(@Model.TotalSum, 2) Kr</p>

<br />



<div class="container">
    <h1 class="display-4">@Model.RecepieProductView.RecipeName</h1>

    <hr class="my-4">
    <br />
    <br />

    <div class="row" style="padding:15px;">
        <div class="col-md-6">
            <h4>Ingredienser:</h4>
            <br />
            <ul class="list-group w-100">

                @foreach (var itemR in Model.RecepieProductView.Productslist)
                {
                    <li class="list-group-item">
                        <label><input type="checkbox" checked="checked"> @itemR.ProductName  @itemR.ProductQuantity  @itemR.Measurement </label>
                    </li>
                }

            </ul>
        </div>

        <div class="table">
            <p class="text-black-50" style="text-align:left; padding: 10px;">Portioner:</p>
            @{
                var parmsparams = new Dictionary<string, string>
                                        {
                    { "id", Model.RecepieProductView.RecipeID.ToString() },
                    { "portion", (Model.RecepieProductView.Portion + 1).ToString() }
                };
                var lowerparmsparams = new Dictionary<string, string>
                                        {
                    { "id", Model.RecepieProductView.RecipeID.ToString() },
                    { "portion", (Model.RecepieProductView.Portion - 1 ).ToString() }
                };
            }
            <input type="text" value="@Model.RecepieProductView.Portion" style="text-align: center; float:left; width:3%;" />
            <br />
            <br />
            <a type="button" class="btn btn-danger" style=" text-align: right; float: left; margin-right: 1px;" asp-controller="Recipe" asp-action="ViewRecipe" asp-all-route-data="@lowerparmsparams">-</a>
            <a type="button" class="btn btn-success" style="text-align: right; float: left;" asp-controller="Recipe" asp-action="ViewRecipe" asp-all-route-data="@parmsparams">+</a>
            <br />
            <br />

        </div>
    </div>
</div>




<a class="btn btn-outline-dark" asp-controller="Recipe" asp-action="Recipes" asp-route-id="default" role="button">Fortsätt handla</a>

@if (SignInManager.IsSignedIn(User))
{
    <a class="btn btn-outline-success" asp-controller="Checkout" asp-action="ViewCart" role="button">Bekräfta order</a>
}
else
{
    <a class="btn btn-outline-success" asp-area="Identity" asp-page="/Account/Login" asp-route-RouteID="-1">Bekräfta order</a>
}





